PRD：FeatureBoard – 功能驱动的迷你任务看板系统

1. 项目概述

项目名称：FeatureBoard
一句话描述：
一个给单人/小团队用的「功能看板」，用来管理要开发的功能项：创建、编辑、按状态和模块筛选，并提供基础统计视图，附带 Playwright 端到端测试。

目标：
	•	作为示例项目，演示如何用「功能驱动 + agent-foreman」方式，让 AI 从 0 到 1 完成一个包含前后端和 E2E 测试的小型系统。
	•	项目规模：5–10 个核心功能，业务简单但链路完整。

⸻

2. 技术栈约束

2.1 前端
	•	框架：Vue 3（Composition API）
	•	构建工具：Vite
	•	样式：Tailwind CSS
	•	图标：lucide-icon（通过官方 Vue 组件或简单封装）
	•	类型：可用 TypeScript（建议）但不是硬性要求

2.2 后端
	•	运行时：Node.js
	•	框架：Hono（运行在 Node 环境即可，不要求 Cloudflare Workers）
	•	数据库：SQLite（本地文件）
	•	ORM：可选（如 Drizzle ORM 或 Prisma），也可直接用 SQL，但要保持代码清晰简单
	•	接口风格：RESTful JSON API

2.3 测试
	•	E2E：Playwright
	•	可选：前端单元测试（如 Vitest），不是硬性要求
	•	所有测试通过 npm 脚本统一执行，方便被 ./ai/init.sh 调用

⸻

3. 用户与使用场景

3.1 用户角色
	•	只有一个角色：开发者/产品本人（无需登录系统）
	•	默认假设这是本地私用的小工具，不涉及权限体系

3.2 使用场景
	•	我有一批要实现的功能，想：
	•	把它们列出来，按模块和状态管理
	•	快速查看当前的开发进度（各状态数量）
	•	记录每条功能的优先级、描述等信息
	•	系统只需要支持单用户，本地运行即可。

⸻

4. 核心数据模型

4.1 Feature（功能项）

字段设计：
	•	id: 唯一标识（自增整数或 UUID）
	•	title: 功能标题（字符串，必填）
	•	description: 功能描述（字符串，可选，支持多行）
	•	module: 所属模块（字符串，比如 backend / frontend / test / other）
	•	status: 状态（枚举）：
	•	todo
	•	doing
	•	done
	•	priority: 优先级（整数 1–5，数字越大优先级越高）
	•	createdAt: 创建时间（ISO 字符串）
	•	updatedAt: 更新时间（ISO 字符串）

数据库：
	•	使用 SQLite 单文件存储所有数据。
	•	初始化时，如果表不存在，需要自动创建。

⸻

5. 功能需求

下面每一条都可以被当作一个「功能项」，AI 后续可以从这里抽取 feature 列表。

功能 1：功能项的后端 CRUD API

描述：
提供基础的 REST API，支持功能项的创建、查询、更新和删除。

详细要求：
	1.	API 基本路径：/api/features
	2.	需要支持的接口：
	•	GET /api/features
	•	支持通过 query 参数过滤：
	•	status（可选：todo / doing / done）
	•	module（可选：任意字符串，完全匹配）
	•	GET /api/features/:id
	•	POST /api/features
	•	请求体 JSON 中必须包含：title
	•	可选字段：description, module, status, priority
	•	如果未提供 status，默认 todo；未提供 priority，默认 3。
	•	PUT /api/features/:id
	•	DELETE /api/features/:id
	3.	所有响应使用 JSON 格式：
	•	成功时返回对象或列表
	•	失败时返回 { error: string } 且 HTTP 状态码合理（如 400/404/500）

验收标准（给 AI 用的自然语言）：
	•	能通过 API 创建新的功能项，并持久化到 SQLite。
	•	刷新应用后，通过 GET /api/features 能看到之前创建的功能项。
	•	可以按 status、module 过滤，返回结果正确。
	•	可以更新某个功能项（如修改 title 或 status），并在后端生效。
	•	可以删除指定功能项。

⸻

功能 2：前端功能列表页（主页）

描述：
实现一个主页面，用于展示功能列表，支持基本状态显示。

详细要求：
	1.	采用 Vue 3 + Tailwind 构建单页应用（SPA），入口路由为 /。
	2.	页面内容包含：
	•	顶部标题栏：显示应用名称，如「FeatureBoard」；
	•	一个按钮「新建功能」；
	•	一个功能列表区域（表格或卡片列表均可）。
	3.	列表中的每一条功能项需要展示：
	•	标题
	•	模块
	•	状态（以小标签/Badge 展示）
	•	优先级（可以用数字或图标）
	4.	需要有加载中和错误状态提示：
	•	初次加载时显示「加载中」状态；
	•	请求失败时显示错误信息。

验收标准：
	•	打开首页时，前端会请求后端 GET /api/features 并显示列表。
	•	如果没有任何功能项，展示空状态提示（如「当前没有功能项」）。
	•	功能列表的数据显示与后端 API 返回的数据一致。
	•	请求出错时，用户可以看到错误提示。

⸻

功能 3：过滤和搜索功能

描述：
在前端提供按状态和模块过滤的能力，方便查看不同维度的功能。

详细要求：
	1.	在列表上方增加过滤控件：
	•	状态过滤下拉框：可选值 全部, 待做, 进行中, 已完成（对应 todo / doing / done）。
	•	模块过滤下拉框或输入框：可选值来源于后端返回的模块列表或用户手动输入。
	2.	当用户更改过滤条件时：
	•	前端调用带查询参数的 GET /api/features 接口获取过滤后的数据。
	•	过滤条件需要反映在 URL 上，例如：
	•	/?status=todo&module=backend
	3.	当用户刷新页面时：
	•	页面的过滤条件应保持一致（从 URL 解析）。

验收标准：
	•	切换状态过滤后，列表内容发生变化，只显示对应状态的功能项。
	•	切换模块过滤后，列表只显示对应模块的功能项。
	•	刷新浏览器后，过滤条件不丢失（通过 URL 保持）。

⸻

功能 4：创建与编辑功能项的表单

描述：
用户可以通过表单创建新的功能项或编辑已有功能项。

详细要求：
	1.	点击「新建功能」按钮时：
	•	弹出对话框，或跳转到一个新的路由 /create。
	2.	表单字段：
	•	标题（必填）
	•	描述（可选，多行）
	•	模块（可选，输入文本或下拉选择）
	•	状态（可选，下拉框，默认 todo）
	•	优先级（可选，1–5 数字选择，默认 3）
	3.	表单校验：
	•	标题为空时不允许提交，并提示错误。
	4.	编辑功能：
	•	在功能列表中，为每个功能项提供「编辑」按钮。
	•	点击后打开编辑表单（可以复用创建表单组件），表单中展示原有数据。
	•	保存后调用 PUT /api/features/:id 接口。

验收标准：
	•	能成功创建新的功能项，并在返回首页时看到它出现在列表中。
	•	编辑功能项后，列表中的数据会立即更新。
	•	表单对必填字段进行校验，错误提示明显。

⸻

功能 5：状态流转操作（Todo → Doing → Done）

描述：
在列表中提供快捷操作，让用户可以方便地切换功能项状态。

详细要求：
	1.	在列表每一条功能项上添加状态切换控件，例如：
	•	一个「推进状态」按钮：
	•	todo → doing → done → 再点击不变或循环回 todo（二选一，设计时明确）。
	•	或者直接使用状态下拉框，允许用户手动选择。
	2.	状态变更时：
	•	前端调用 PUT /api/features/:id 更新对应功能项的 status 字段。
	•	成功后更新前端列表，不需要刷新整页。
	3.	视觉区分：
	•	不同状态的功能项，使用不同的颜色标签或样式；
	•	done 状态可以使用灰色/淡色显示。

验收标准：
	•	在列表中点击状态切换控件，可以看到状态按照预期改变。
	•	刷新页面后，功能项状态保持正确（说明已写入数据库）。
	•	不同状态的功能项在视觉上有明显区分。

⸻

功能 6：统计视图

描述：
提供一个简单的统计区域，帮助用户快速了解当前的功能分布情况。

详细要求：
	1.	后端增加统计接口：
	•	GET /api/features/stats
	•	返回内容示例：

{
  "byStatus": {
    "todo": 5,
    "doing": 2,
    "done": 10
  },
  "byModule": {
    "frontend": 8,
    "backend": 5,
    "test": 4
  }
}


	2.	前端在主页或单独区域展示统计信息，例如：
	•	「待做：5 · 进行中：2 · 已完成：10」
	•	每个模块下有多少功能项。
	3.	当功能列表发生变化（新增/编辑/删除/状态变更）后：
	•	统计视图需要同步更新（可重新请求 stats 接口）。

验收标准：
	•	创建或删除功能项后，统计视图中的数量会相应变化。
	•	不同状态和模块的数量与列表中的真实数据一致。
	•	GET /api/features/stats 返回的数据结构清晰，字段命名与约定一致。

⸻

功能 7：本地偏好设置（记住上次的过滤条件）

描述：
通过本地存储记住用户的过滤偏好，提高使用体验。

详细要求：
	1.	当用户改变状态或模块过滤器时：
	•	除了更新 URL，还将当前筛选条件存入 localStorage。
	2.	当用户直接访问 / 时：
	•	如果 URL 中没有过滤参数，但 localStorage 中有最近一次筛选条件，则使用该条件初始化过滤器和列表。
	3.	如果用户手动修改 URL 的查询参数：
	•	URL 优先级高于本地存储。

验收标准：
	•	用户设置了一次过滤条件后，关闭浏览器窗口再打开页面，过滤条件仍然有效。
	•	清理浏览器本地存储（如用 DevTools 清除）后，页面恢复默认过滤条件（全部）。

⸻

功能 8：Playwright 端到端测试

描述：
使用 Playwright 为关键用户流程编写 E2E 测试，确保最核心功能在浏览器中工作正常。

详细要求：
	1.	使用 Playwright（TypeScript 或 JavaScript 均可）：
	•	建立基本的测试项目脚手架。
	2.	至少覆盖如下场景：
	•	场景 1：打开首页，看到空列表提示。
	•	场景 2：通过表单创建一个功能项，保存后出现在列表中。
	•	场景 3：切换功能项状态（todo → doing → done），UI 状态标签随之变化。
	•	场景 4：使用状态过滤器，仅显示指定状态的功能项。
	•	场景 5（可选）：删除一个功能项后，不再出现在列表中，统计视图同步更新。
	3.	测试运行方式：
	•	提供 npm run test:e2e 命令执行 Playwright 测试。
	•	测试应在本地环境中可靠通过（需要确保测试前数据库状态可控，如每次测试前清空/重置数据库）。

验收标准：
	•	在本地运行 npx playwright test（或 npm run test:e2e）全部通过且退出码为 0。
	•	上述列出的关键场景在测试脚本中都有覆盖。
	•	测试脚本在项目结构中组织清晰（如 tests/e2e 目录）。

⸻

6. 非功能性要求
	1.	项目结构清晰：前后端代码、测试代码各有独立目录，容易被 AI 和人类理解。
	2.	开发体验：
	•	可通过简单命令启动：
	•	npm install
	•	npm run dev（前后端可以共用一个脚本，或分开）
	•	README 中需简要说明安装和启动方式。
	3.	无外部服务依赖：
	•	不依赖外部 API、第三方数据库或云服务，所有数据使用本地 SQLite 存储。
	4.	可读性：
	•	代码尽量简洁、模块化，方便后续 AI 和人类继续在这个项目上迭代功能。

